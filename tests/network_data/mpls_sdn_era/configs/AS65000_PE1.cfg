!! IOS XR Configuration 6.3.1
!
lldp
exit
!
xml agent tty iteration off
!
hostname AS65000_PE1
!
line console
 exec-timeout 0 0
 session-timeout 0
!
line default
 exec-timeout 0 0
 session-timeout 0
 !!
vrf VRF-A
address-family ipv4 unicast
ipv4 unnumbered mpls traffic-eng Loopback0
!
interface Gi0/0/0/1.1001
 vrf VRF-A
 description TO_AS65001_CE1
 ipv4 address 10.1.0.1/31
 encapsulation dot1q 1001
 no shutdown
!
interface Gi0/0/0/2.1001
 vrf VRF-A
 description TO_AS65001_CE2
 ipv4 address 10.1.0.7/31
 encapsulation dot1q 1001
 no shutdown
!
!
interface Gi0/0/0/3
 description TO_EDGE_PE2
 ipv4 address 10.0.0.0/31
!
!
interface Gi0/0/0/4
 description TO_CORE_P1
 ipv4 address 10.0.0.2/31
!
!
interface Loopback0
 description SYSTEM_LO_IP
 ipv4 address 172.16.0.11/32
route-policy PL-iBGP-RR-OUT
set next-hop self
end-policy
!
route-policy PL-EBGP-CE1-OUT
  set med 100
  pass
end-policy
!
route-policy PL-EBGP-CE2-OUT
  set med 200
  pass
end-policy
!
!
!
route-policy PL-EBGP-65001-IN
  pass
end-policy
!
!
router isis core
 is-type level-2-only
 net 49.0000.1720.1600.0011.00
 address-family ipv4 unicast
  metric-style wide
  mpls traffic-eng level-2-only
  maximum-paths 8
 !
 !
interface Gi0/0/0/3
 point-to-point
 address-family ipv4 unicast
  metric 100 level 2
!
interface Gi0/0/0/4
 point-to-point
 address-family ipv4 unicast
  metric 100 level 2
interface Loopback0
 passive
 address-family ipv4 unicast
 !
!
router bgp 65000
bgp router-id 172.16.0.11
address-family ipv4 unicast
address-family vpnv4 unicast
additional-paths receive
additional-paths send
!
neighbor-group RR
 remote-as 65000
 update-source Loopback0
 address-family ipv4 unicast
 route-policy PL-iBGP-RR-OUT out
 soft-reconfiguration inbound always
!
neighbor 172.16.0.201
use neighbor-group RR
!
neighbor 172.16.0.202
use neighbor-group RR
!
!

vrf VRF-A
 bgp router-id 100.1.1.1
 rd 172.16.0.11:1001
 address-family ipv4 unicast
 !
 neighbor 10.1.0.6
  remote-as 65001
  update-source Gi0/0/0/2.1001
  address-family ipv4 unicast
   route-policy PL-EBGP-65001-IN in
   route-policy PL-EBGP-CE2-OUT out
 neighbor 10.1.0.0
  remote-as 65001
  update-source Gi0/0/0/1.1001
  address-family ipv4 unicast
   route-policy PL-EBGP-65001-IN in
   route-policy PL-EBGP-CE1-OUT out
!
router static
 address-family ipv4 unicast
  0.0.0.0/0 Null0
 !
 
mpls oam
!
mpls ldp
!
!
mpls traffic-eng
interface Gi0/0/0/3
!
mpls traffic-eng
interface Gi0/0/0/4
!
!
group GR-LSP
interface 'tunnel-te.*'
ipv4 unnumbered Loopback0
fast-reroute protect node
autoroute announce
exit
record-route
path-option 1 dynamic
no shutdown
exit
exit
